var von2d={};von2d.Rectangle=function(){var t=function(t,i,s,e){this.x=t||0,this.y=i||0,this.width=s||0,this.height=e||0};return t.prototype.copy=function(t){t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var s=this.x;if(t>=s&&t<=s+this.width){var e=this.y;if(i>=e&&i<=e+this.height)return!0}return!1},t.prototype.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},t}({}),von2d.VonPixi=function(t,i){var i=i,s={blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},blendModesCanvas:[],scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},EmptyRectangle:new i};return s}({},von2d.Rectangle),von2d.Point=function(){var t=function(t,i){this.x=t||0,this.y=i||0};return t.prototype.copy=function(t){t.x=this.x,t.y=this.y},t.prototype.reset=function(t,i){this.x=t||0,this.y=i||(0!==i?this.x:0)},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},t}({}),von2d.Matrix2=function(){var t=function(t,i,s,e,h,n){return this.a=t?t:1,this.b=i||0,this.c=s||0,this.d=e?e:1,this.tx=h||0,this.ty=n||0,this},i=Math.PI,s=2*i;return t.identity=null,t.DEG_TO_RAD=Math.PI/180,t.prototype.prepend=function(t,i,s,e,h,n){var r,o,a=this.tx;return(1!==t||0!==i||0!==s||1!==e)&&(r=this.a,o=this.c,this.a=r*t+this.b*s,this.b=r*i+this.b*e,this.c=o*t+this.d*s,this.d=o*i+this.d*e),this.tx=a*t+this.ty*s+h,this.ty=a*i+this.ty*e+n,this},t.prototype.append=function(t,i,s,e,h,n){var r=this.a,o=this.b,a=this.c,d=this.d;return this.a=t*r+i*a,this.b=t*o+i*d,this.c=s*r+e*a,this.d=s*o+e*d,this.tx=h*r+n*a+this.tx,this.ty=h*o+n*d+this.ty,this},t.prototype.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty),this},t.prototype.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty),this},t.prototype.prependTransform=function(t,i,e,h,n,r,o,a,d){var l,p;return n%s?(l=Math.cos(n),p=Math.sin(n)):(l=1,p=0),(a||d)&&(this.tx-=a,this.ty-=d),r||o?(this.prepend(l*e,p*e,-p*h,l*h,0,0),this.prepend(Math.cos(o),Math.sin(o),-Math.sin(r),Math.cos(r),t,i)):this.prepend(l*e,p*e,-p*h,l*h,t,i),this},t.prototype.appendTransform=function(t,i,e,h,n,r,o,a,d){var l,p;return n%s?(l=Math.cos(n),p=Math.sin(n)):(l=1,p=0),r||o?(this.append(Math.cos(o),Math.sin(o),-Math.sin(r),Math.cos(r),t,i),this.append(l*e,p*e,-p*h,l*h,0,0)):this.append(l*e,p*e,-p*h,l*h,t,i),(a||d)&&(this.tx-=a*this.a+d*this.c,this.ty-=a*this.b+d*this.d),this},t.prototype.rotate=function(t){var i=Math.cos(t),s=Math.sin(t),e=this.a,h=this.c,n=this.tx;return this.a=e*i-this.b*s,this.b=e*s+this.b*i,this.c=h*i-this.d*s,this.d=h*s+this.d*i,this.tx=n*i-this.ty*s,this.ty=n*s+this.ty*i,this},t.prototype.skew=function(t,i){return this.append(Math.cos(i),Math.sin(i),-Math.sin(t),Math.cos(t),0,0),this},t.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},t.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},t.prototype.invert=function(){var t=this.a,i=this.b,s=this.c,e=this.d,h=this.tx,n=t*e-i*s;return this.a=e/n,this.b=-i/n,this.c=-s/n,this.d=t/n,this.tx=(s*this.ty-e*h)/n,this.ty=-(t*this.ty-i*h)/n,this},t.prototype.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},t.prototype.transformPoint=function(t,i,s){return s=s||{},s.x=t*this.a+i*this.c+this.tx,s.y=t*this.b+i*this.d+this.ty,s},t.prototype.decompose=function(t){t||(t={}),t.x=this.tx,t.y=this.ty,t.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),t.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var s=Math.atan2(-this.c,this.d),e=Math.atan2(this.b,this.a);return s==e?(t.rotation=e,this.a<0&&this.d>=0&&(t.rotation+=t.rotation<=0?i:-i),t.skewX=t.skewY=0):(t.skewX=s,t.skewY=e),t},t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var i=this.array;return t?(this.array[0]=this.a,this.array[1]=this.c,this.array[2]=0,this.array[3]=this.b,this.array[4]=this.d,this.array[5]=0,this.array[6]=this.tx,this.array[7]=this.ty,this.array[8]=1):(this.array[0]=this.a,this.array[1]=this.b,this.array[2]=this.tx,this.array[3]=this.c,this.array[4]=this.d,this.array[5]=this.ty,this.array[6]=0,this.array[7]=0,this.array[8]=1),i},t.prototype.copy=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.toString=function(){return"[Matrix2 (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},t.identity=new t,t}({}),von2d.DisplayObject=function(t,i,s,e,h){var i=i,s=s,e=e,n=h,r=function(){this.uniqueId=Math.random().toString(36).slice(2)+Date.now(),this.position=new s,this.scale=new s(1,1),this.pivot=new s,this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this.worldTransform=new n,this._sr=0,this._cr=1,this._bounds=new e(0,0,1,1),this._currentBounds=null,this._parentTransform=null,this._a00=0,this._a01=0,this._a10=0,this._a11=0,this._a02=0,this._a12=0,this._b00=0,this._b10=0};return Object.defineProperty(r.prototype,"worldVisible",{get:function(){for(var t=this;t;){if(!t.visible)return!1;t=t.parent}return!0}}),r.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),this._parentTransform=this.parent.worldTransform,this._a00=this._cr*this.scale.x,this._a01=-this._sr*this.scale.y,this._a10=this._sr*this.scale.x,this._a11=this._cr*this.scale.y,this._a02=this.position.x-this._a00*this.pivot.x-this.pivot.y*this._a01,this._a12=this.position.y-this._a11*this.pivot.y-this.pivot.x*this._a10,this._b00=this._parentTransform.a,this._b01=this._parentTransform.b,this._b10=this._parentTransform.c,this._b11=this._parentTransform.d,this.worldTransform.a=this._b00*this._a00+this._b01*this._a10,this.worldTransform.b=this._b00*this._a01+this._b01*this._a11,this.worldTransform.tx=this._b00*this._a02+this._b01*this._a12+this._parentTransform.tx,this.worldTransform.c=this._b10*this._a00+this._b11*this._a10,this.worldTransform.d=this._b10*this._a01+this._b11*this._a11,this.worldTransform.ty=this._b10*this._a02+this._b11*this._a12+this._parentTransform.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},r.prototype.getBounds=function(t){return t=t,i.EmptyRectangle},r.prototype.setStageReference=function(t){this.stage=t},r.prototype.draw=function(t){t=t},Object.defineProperty(r.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(r.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),r}({},von2d.VonPixi,von2d.Point,von2d.Rectangle,von2d.Matrix2),von2d.Sprite=function(t,i,s,e,h){var i=i,s=s,e=e,h=h,n=function(t,n){s.call(this),this.anchor=new e(.5,.5),this.texture=t,this._width=n?n.width:t.width,this._height=n?n.height:t.height,this.frame=n||new h(0,0,t.width,t.height),this.scale.x=this._width/this.frame.width,this.scale.y=this._height/this.frame.height,this.blendMode=i.blendModes.NORMAL,this.renderable=!0};return n.prototype=Object.create(s.prototype),n.prototype.constructor=n,Object.defineProperty(n.prototype,"width",{get:function(){return this.scale.x*this.frame.width},set:function(t){this.scale.x=t/this.frame.width,this._width=t}}),Object.defineProperty(n.prototype,"height",{get:function(){return this.scale.y*this.frame.height},set:function(t){this.scale.y=t/this.frame.height,this._height=t}}),n.prototype.getBounds=function(t){var i=this.frame.width,s=this.frame.height,e=i*(1-this.anchor.x),h=i*-this.anchor.x,n=s*(1-this.anchor.y),r=s*-this.anchor.y,o=t||this.worldTransform,a=o.a,d=o.c,l=o.b,p=o.d,c=o.tx,u=o.ty,f=a*h+l*r+c,y=p*r+d*h+u,v=a*e+l*r+c,b=p*r+d*e+u,x=a*e+l*n+c,g=p*n+d*e+u,w=a*h+l*n+c,m=p*n+d*h+u,M=-1/0,_=-1/0,T=1/0,C=1/0;T=T>f?f:T,T=T>v?v:T,T=T>x?x:T,T=T>w?w:T,C=C>y?y:C,C=C>b?b:C,C=C>g?g:C,C=C>m?m:C,M=f>M?f:M,M=v>M?v:M,M=x>M?x:M,M=w>M?w:M,_=y>_?y:_,_=b>_?b:_,_=g>_?g:_,_=m>_?m:_;var j=this._bounds;return j.x=T,j.width=M-T,j.y=C,j.height=_-C,this._currentBounds=j,j},n.prototype.draw=function(t){t.globalAlpha=this.worldAlpha,t.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx,this.worldTransform.ty),t.drawImage(this.texture,this.frame.x,this.frame.y,this.frame.width,this.frame.height,this.anchor.x*-this.frame.width,this.anchor.y*-this.frame.height,this.frame.width,this.frame.height)},n}({},von2d.VonPixi,von2d.DisplayObject,von2d.Point,von2d.Rectangle),von2d.LinkedList=function(){var t=function(){this.obj=null,this.next=null,this.prev=null,this.free=!0};window.LinkedListNode=t;var i=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueId=Date.now()+""+Math.floor(1e3*Math.random()),this.getNode=function(t){return this.objToNodeMap[t.uniqueId]},this.addNode=function(i){var s=new t;return s.obj=i,s.prev=null,s.next=null,s.free=!1,this.objToNodeMap[i.uniqueId]=s,s},this.add=function(t){var i=this.objToNodeMap[t.uniqueId];if(i){if(i.free===!1)return;i.obj=t,i.free=!1,i.next=null,i.prev=null}else i=this.addNode(t);if(this.first){if(null==this.last)throw new Error("Hmm, no last in the list -- that shouldn't happen here");this.last.next=i,i.prev=this.last,this.last=i,i.next=null}else this.first=i,this.last=i,i.next=null,i.prev=null;this.length++,this.showDebug&&this.dump("after add")},this.has=function(t){return!!this.objToNodeMap[t.uniqueId]},this.moveUp=function(t){this.dump("before move up");var i=this.getNode(t);if(!i)throw"Oops, trying to move an object that isn't in the list";if(null!=i.prev){var s=i.prev,e=s.prev;i==this.last&&(this.last=s);var h=i.next;e&&(e.next=i),i.next=s,i.prev=s.prev,s.next=h,s.prev=i,this.first==s&&(this.first=i)}},this.moveDown=function(t){var i=this.getNode(t);if(!i)throw"Oops, trying to move an object that isn't in the list";if(null!=i.next){var s=i.next;this.moveUp(s.obj),this.last==s&&(this.last=i)}},this.sort=function(t){for(var i,s,e=[],h=this.first;h;)e.push(h.object()),h=h.next();for(this.clear(),e.sort(t),s=e.length,i=0;s>i;i++)this.add(e[i])},this.remove=function(t){var i=this.getNode(t);return null==i||1==i.free?!1:(null!=i.prev&&(i.prev.next=i.next),null!=i.next&&(i.next.prev=i.prev),null==i.prev&&(this.first=i.next),null==i.next&&(this.last=i.prev),i.free=!0,i.prev=null,i.next=null,this.length--,!0)},this.shift=function(){var t=this.first;return 0===this.length?null:(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.first=t.next,t.next||(this.last=null),t.free=!0,t.prev=null,t.next=null,this.length--,t.obj)},this.pop=function(){var t=this.last;return 0===this.length?null:(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.last=t.prev,t.prev||(this.first=null),t.free=!0,t.prev=null,t.next=null,this.length--,t.obj)},this.clear=function(){for(var t=this.first;t;)t.free=!0,t=t.next;this.first=null,this.length=0},this.dispose=function(){for(var t=this.first;t;)t.obj=null,t=t.next;this.first=null,this.objToNodeMap=null},this.dump=function(t){console.log("===================="+t+"=====================");for(var i=this.first;null!=i;)console.log("{"+i.obj.toString()+"} previous="+(i.prev?i.prev.obj:"NULL")),i=i.next();console.log("==================================="),console.log("Last: {"+(this.last?this.last.obj:"NULL")+"} First: {"+(this.first?this.first.obj:"NULL")+"}")}};return window.LinkedList=i,i}(),von2d.Container=function(t,i,s,e){var i=i,s=s,e=e;return Container=function(){s.call(this),this.children=new e},Container.prototype=Object.create(s.prototype),Container.prototype.constructor=Container,Container.prototype.addChild=function(t){var i,s=arguments.length;if(s>1){for(i=0;s>i;i++)this.addChild(arguments[i]);return arguments[s-1]}return t.parent&&t.parent.removeChild(t),t.parent=this,this.stage&&t.setStageReference(this.stage),this.children.add(t),t},Container.prototype.removeChild=function(t){return t.parent=null,this.stage&&(t.stage=null),this.children.remove(t)},Container.prototype.contains=function(t){for(;t;){if(t===this)return!0;t=t.parent}return!1},Container.prototype.updateTransform=function(){var t;if(this.visible)for(s.prototype.updateTransform.call(this),t=this.children.first;t;)t.obj.updateTransform(),t=t.next},Container.prototype.getBounds=function(t){var s;if(0===this.children.length)return i.EmptyRectangle;if(t){var e=this.worldTransform;this.worldTransform=t,this.updateTransform(),this.worldTransform=e}var h,n,r,o=1/0,a=1/0,d=-1/0,l=-1/0,p=!1;for(s=this.children.first;s;)s.obj.visible?(p=!0,h=s.obj.getBounds(t),o=o<h.x?o:h.x,a=a<h.y?a:h.y,n=h.width+h.x,r=h.height+h.y,d=d>n?d:n,l=l>r?l:r,s=s.next):s=s.next;if(!p)return i.EmptyRectangle;var c=this._bounds;return c.x=o,c.y=a,c.width=d-o,c.height=l-a,c},Container.prototype.getLocalBounds=function(){var t,i=this.worldTransform;for(this.worldTransform=identityMatrix,t=this.children.first;t;)t.obj.updateTransform(),t=t.next;var s=this.getBounds();return this.worldTransform=i,s},Container.prototype.setStageReference=function(t){var i;for(this.stage=t,i=this.children.first;i;)i.obj.setStageReference(t),i=i.next},Container.prototype.removeStageReference=function(){for(var t=this.children.first;t;)t.obj.removeStageReference(),t=t.next;this._interactive&&(this.stage.dirty=!0),this.stage=null},Container.prototype.draw=function(t){var i;if(this.visible!==!1&&0!==this.alpha)for(i=this.children.first;i;)i.obj.visible&&i.obj.alpha>0&&i.obj.draw(t),i=i.next},Container}({},von2d.VonPixi,von2d.DisplayObject,von2d.LinkedList),von2d.Stage=function(t,i,s,e){var i=i,s=s,h=e,n=function(t,e,n){s.call(this),this.clearBeforeRender=!0,i.blendModesCanvas[i.blendModes.NORMAL]="source-over",i.blendModesCanvas[i.blendModes.ADD]="lighter",i.blendModesCanvas[i.blendModes.MULTIPLY]="multiply",i.blendModesCanvas[i.blendModes.SCREEN]="screen",i.blendModesCanvas[i.blendModes.OVERLAY]="overlay",i.blendModesCanvas[i.blendModes.DARKEN]="darken",i.blendModesCanvas[i.blendModes.LIGHTEN]="lighten",i.blendModesCanvas[i.blendModes.COLOR_DODGE]="color-dodge",i.blendModesCanvas[i.blendModes.COLOR_BURN]="color-burn",i.blendModesCanvas[i.blendModes.HARD_LIGHT]="hard-light",i.blendModesCanvas[i.blendModes.SOFT_LIGHT]="soft-light",i.blendModesCanvas[i.blendModes.DIFFERENCE]="difference",i.blendModesCanvas[i.blendModes.EXCLUSION]="exclusion",i.blendModesCanvas[i.blendModes.HUE]="hue",i.blendModesCanvas[i.blendModes.SATURATION]="saturation",i.blendModesCanvas[i.blendModes.COLOR]="color",i.blendModesCanvas[i.blendModes.LUMINOSITY]="luminosity",this.width=t||800,this.height=e||600,this.view=n||document.createElement("canvas"),this.context=this.view.getContext("2d"),this.view.width=this.width,this.view.height=this.height,this.worldTransform=new h,this.stage=this};return n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.draw=function(){var t=this.children.first;for(this.worldAlpha=1;t;)t.obj.updateTransform(),t=t.next;for(this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.clearBeforeRender&&this.context.clearRect(0,0,this.width,this.height),t=this.children.first;t;)t.obj.visible&&t.obj.alpha>0&&t.obj.draw(this.context),t=t.next},n.prototype.resize=function(t,i){this.width=t,this.height=i,this.view.width=t,this.view.height=i},n}({},von2d.VonPixi,von2d.Container,von2d.Matrix2);